# Using Hooks in Experiment-Runner
Hooks are special functions that allow you to define custom actions at specific points during the experiment lifecycle. In Experiment-Runner, hooks are defined in the RunnerConfig class, and you can use them to perform actions such as preparing data, starting measurements, or handling the results.

Here are the key hooks you will be working with in the following two exercises:
before_experiment(): This hook is called once before the experiment starts.
after_experiment(): This hook is called once after the experiment ends.

## Exercise
Add Git committing in the before_experiment() hook


## Bonus Ex
Move the result file in the after_experiment() hook

Let's get started!

Understanding Hooks in Experiment-Runner

Exercise 1: Add Git Committing in before_experiment()
In this exercise, you will modify the before_experiment() hook to automatically commit any changes to your Git repository before the experiment starts. This ensures that any modifications made to your code or configuration are saved and version-controlled.

Steps:
Open RunnerConfig.py: Locate the RunnerConfig class in your project.

Find the before_experiment() Method: Look for the method defined as:

def before_experiment(self) -> None:
    """Perform any activity required before starting the experiment here
    Invoked only once during the lifetime of the program."""
Add Git Commit Commands: Modify the before_experiment() method to add the following lines:


def before_experiment(self) -> None:
    """Perform any activity required before starting the experiment here."""
    
    # Add and commit changes to Git
    try:
        git_cmd = f'git add . && git commit -m "Auto-commit before experiment at {datetime.now().strftime("%Y-%m-%d %H:%M:%S")}"'
        subprocess.run(git_cmd, shell=True, check=True)
        output.console_log("Successfully committed changes to Git!")
    except subprocess.CalledProcessError as e:
        output.console_log_FAIL(f"Failed to commit changes to Git: {e}")
    
    output.console_log("Config.before_experiment() called!")
Explanation:

git add .: Adds all changes to the staging area.
git commit -m: Commits the changes with a message that includes the current timestamp.
This will ensure all changes are backed up to the Git repository before the experiment begins.
Exercise 2: Move the Result File in after_experiment()
In this exercise, you will modify the after_experiment() hook to move the result file (run_table.csv) to another folder after the experiment completes. This ensures the results are organized and easy to find.

Steps:
Open RunnerConfig.py: Locate the RunnerConfig class in your project.

Find the after_experiment() Method: Look for the method defined as:


def after_experiment(self) -> None:
    """Perform any activity required after stopping the experiment here
    Invoked only once during the lifetime of the program."""
Add File Moving Logic: Modify the after_experiment() method to add the following lines:


def after_experiment(self) -> None:
    """Perform any activity required after stopping the experiment here."""
    
    output.console_log("Config.after_experiment() called!")

    # Define the source and destination paths for the result file
    result_file = self.results_output_path / self.name / "run_table.csv"
    destination_dir = self.ROOT_DIR / "results_archive"  # Destination directory
    destination_dir.mkdir(parents=True, exist_ok=True)   # Create directory if it doesn't exist

    # Move the result file to the destination directory
    if result_file.exists():
        result_file.rename(destination_dir / result_file.name)
        output.console_log_OK(f"Successfully moved the result file to {destination_dir}")
    else:
        output.console_log_FAIL(f"Result file not found: {result_file}")
Explanation:

result_file.rename(destination_dir / result_file.name): Moves the result file to the destination directory.
destination_dir.mkdir(parents=True, exist_ok=True): Creates the destination directory if it does not exist.
This will organize your results by moving them to a specified folder after the experiment.
Conclusion
By completing these two exercises, you have learned how to:

Use the before_experiment() hook to perform Git commits.
Use the after_experiment() hook to move result files to a designated folder.
These tasks help automate the management of experiment-related files and ensure that all changes are version-controlled and organized. Try extending these hooks further to add your own custom functionality!

Feel free to ask questions or experiment with these hooks to better understand how they work in the Experiment-Runner tool!